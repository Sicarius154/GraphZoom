!function(a){"use strict";var b=function(b){b&&b("core","snapToGrid",function(b){var c=this,d=b,e=c.container(),f={stackOrder:-1,gridSpacing:40,strokeStyle:"#CCCCCC",lineWidth:1,lineDash:[5,8],zoomDash:!0,panGrid:!0,snapToGrid:!0,drawGrid:!0},g={snapOn:function(){a(this).trigger("snaptogrid.snapon")},snapOff:function(){a(this).trigger("snaptogrid.snapoff")},gridOn:function(){a(this).trigger("snaptogrid.gridon")},gridOff:function(){a(this).trigger("snaptogrid.gridoff")},refresh:function(){a(this).trigger("snaptogrid.refresh")},option:function(b,c){var d=a(this),e=d.data("snapToGrid");if(null!=e){var f=e.options;if(void 0===c){if(typeof b!=typeof{})return f[b];var g=b;f=a.extend(!0,{},defaults,g),e.options=f}else f[b]=c;return d.data("snapToGrid",e),d.trigger("snaptogrid.refresh"),d}},init:function(){var g,d=a("<canvas></canvas>"),e=a(this),h=a.extend(!0,{},f,b);e.data("snapToGrid",h);var i,j=function(){return i||(i=e.data("snapToGrid"))},k=function(){d.attr("height",e.height()).attr("width",e.width()).css({position:"absolute",top:0,left:0,"z-index":j().stackOrder}),setTimeout(function(){var a=d.offset(),b=e.offset();d.attr("height",e.height()).attr("width",e.width()).css({top:-(a.top-b.top),left:-(a.left-b.left)}),l()},0)},l=function(){if(m(),j().drawGrid){var a=c.zoom(),b=e.width(),d=e.height(),f=j().gridSpacing*a,h=c.pan(),i=h.x%f,k=h.y%f;if(g.strokeStyle=j().strokeStyle,g.lineWidth=j().lineWidth,j().zoomDash){for(var l=j().lineDash.slice(),n=0;n<l.length;n++)l[n]=j().lineDash[n]*a;g.setLineDash(l)}else g.setLineDash(j().lineDash);j().panGrid?g.lineDashOffset=-h.y:g.lineDashOffset=0;for(var n=i;n<b;n+=f)g.beginPath(),g.moveTo(n,0),g.lineTo(n,d),g.stroke();j().panGrid?g.lineDashOffset=-h.x:g.lineDashOffset=0;for(var n=k;n<d;n+=f)g.beginPath(),g.moveTo(0,n),g.lineTo(b,n),g.stroke()}},m=function(){var a=e.width(),b=e.height();g.clearRect(0,0,a,b)},n=function(a){var b=a.position(),c=Math.floor(b.x/j().gridSpacing),d=Math.floor(b.y/j().gridSpacing);a.position({x:(c+.5)*j().gridSpacing,y:(d+.5)*j().gridSpacing})},o=function(){c.nodes().each(function(a){n(a)})},p=function(a){j().snapToGrid&&n(a.target)},q=function(a){j().snapToGrid&&n(a.target)},r=function(){j().snapToGrid=!0,o()},s=function(){j().snapToGrid=!1},t=function(){j().drawGrid=!0,l()},u=function(){j().drawGrid=!1,l()};e.append(d),a(window).on("resize",k),e.on("snaptogrid.snapon",r),e.on("snaptogrid.snapoff",s),e.on("snaptogrid.gridon",t),e.on("snaptogrid.gridoff",u),e.on("snaptogrid.refresh",k),g=d[0].getContext("2d"),c.ready(function(){k(),j().snapToGrid&&o(),c.on("zoom",l),c.on("pan",l),c.on("free",p),c.on("add",q)})}};return g[d]?g[d].apply(e,Array.prototype.slice.call(arguments,1)):"object"!=typeof d&&d?(console.error("No such function `"+d+"` for snapToGrid"),this):g.init.apply(e,arguments)})};"undefined"!=typeof module&&module.exports&&(module.exports=b),"undefined"!=typeof define&&define.amd&&define("cytoscape-snap-to-grid",function(){return b}),"undefined"!=typeof cytoscape&&b(cytoscape)}("undefined"!=typeof jQuery?jQuery:null);
